import{Signal as e,signal as t,computed as n,effect as r}from"@preact/signals-core";export{Signal,batch,computed,effect,signal,untracked}from"@preact/signals-core";import o,{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED as i,useMemo as f,useRef as u,useEffect as c}from"react";import{useSyncExternalStore as s}from"use-sync-external-store/shim/index.js";import l from"react/jsx-runtime";import a from"react/jsx-dev-runtime";let m=!1,p=null,b=!1,d=null;const g=new Map;function y(e){if(!e)return 1;const t=g.get(e);if(void 0!==t)return t;let n;const r=e.useCallback.toString();if(e.useReducer===e.useEffect)n=1;else if(e.useEffect===e.useImperativeHandle)n=32;else if(/Invalid/.test(r))n=2;else if(/updateCallback/.test(r)||/\[0\]/.test(r)&&/\[1\]/.test(r)){let t=e.useReducer.toString();if(/rerenderReducer/.test(t)||/return\s*\[\w+,/.test(t))n=16;else n=8}else n=4;g.set(e,n);return n}const v=[],h=Symbol.for("react.element"),S=()=>{};function x(t){if("function"!=typeof t)return t;else return function(n,r,...o){if("string"==typeof n&&r)for(let t in r){let n=r[t];if("children"!==t&&n instanceof e)r[t]=n.value}return t.call(t,n,r,...o)}}const j=Symbol.dispose||Symbol.for("Symbol.dispose");let _;function k(e){if(_)_();_=e&&e.effect.S()}const w=()=>k(),O={effect:{s:void 0,c(){},S:()=>S,d(){}},subscribe:()=>S,getSnapshot:()=>0,f(){},[j](){}};let P;const $=Promise.prototype.then.bind(Promise.resolve());function B(){w();if(!P)P=$(()=>{P=void 0;w()});const e=u();if(null==e.current)e.current=function(){let e,t,n=0,o=r(function(){e=this});e.c=function(){n=n+1|0;if(t)t()};return{effect:e,subscribe(e){t=e;return function(){n=n+1|0;t=void 0;o()}},getSnapshot:()=>n,f(){w()},[j](){w()}}}();const t=e.current;s(t.subscribe,t.getSnapshot,t.getSnapshot);k(t);return t}Object.defineProperties(e.prototype,{$$typeof:{configurable:!0,value:h},type:{configurable:!0,value:function({data:e}){const t=function(){if(m)return O;else return B()}();try{return e.value}finally{t.f()}}},props:{configurable:!0,get(){return{data:this}}},ref:{configurable:!0,value:null}});function useSignal(e){return f(()=>t(e),v)}function useComputed(e){const t=u(e);t.current=e;return f(()=>n(()=>t.current()),v)}function useSignalEffect(e){const t=u(e);t.current=e;c(()=>r(()=>t.current()),v)}!function(){!function(){m=!0;Object.defineProperty(i.ReactCurrentDispatcher,"current",{get:()=>d,set(e){if(b){d=e;return}const t=y(d),n=y(e);d=e;if(function(e,t){if(1&e&&28&t)return!0;else if(2&e||2&t)return!1;else if(16&t)return!0;else return!1}(t,n)){b=!0;p=B();b=!1}else if(function(e,t){return Boolean(28&e&&1&t)}(t,n)){var r;null==(r=p)||r.f();p=null}}})}();!function(){const e=l,t=a;o.createElement=x(o.createElement);t.jsx&&(t.jsx=x(t.jsx));e.jsx&&(e.jsx=x(e.jsx));t.jsxs&&(t.jsxs=x(t.jsxs));e.jsxs&&(e.jsxs=x(e.jsxs));t.jsxDEV&&(t.jsxDEV=x(t.jsxDEV));e.jsxDEV&&(e.jsxDEV=x(e.jsxDEV))}()}();export{useComputed,useSignal,useSignalEffect};//# sourceMappingURL=signals.mjs.map
